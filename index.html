<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹»å¢ƒ PPT åŠ©æ‰‹</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- PptxGenJS -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@300;400;500&family=Cinzel:wght@400;700&family=Montserrat:wght@400;800&family=Playfair+Display:wght@400;700&family=Roboto:wght@400;700&family=Merriweather:wght@400;700&family=Nunito:wght@400;700&family=Libre+Baskerville:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="h-screen w-screen overflow-hidden bg-[#05080a] relative flex items-center justify-center" :class="{ 'reduce-motion': !visualConfig.enableAnimations }">

    <!-- åŠ è½½é®ç½© -->
    <div id="app-loading" class="app-loading">
        <div class="spinner"></div>
    </div>

    <canvas id="particle-canvas"></canvas>
    <div class="scanlines"></div>
    <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/dark-matter.png')] opacity-20 pointer-events-none"></div>

    <!-- å‰æ™¯è§†å·®è£…é¥°çº¿æ¡ -->
    <div class="parallax-accent-line accent-line-1 parallax-foreground"></div>
    <div class="parallax-accent-line accent-line-2 parallax-foreground"></div>
    <div class="parallax-accent-line accent-line-3 parallax-foreground"></div>
    <div class="parallax-accent-line accent-line-4 parallax-foreground"></div>
    <div class="parallax-accent-line accent-line-5 parallax-foreground"></div>
    <div class="parallax-accent-line accent-line-6 parallax-foreground"></div>

    <!-- å¯åŠ¨ä»ªå¼å…‰æ™•æ•ˆæœ -->
    <div id="launch-glow" class="launch-glow"></div>

    <div id="app" v-cloak class="relative z-10 w-full h-full flex flex-col items-center justify-center p-4">

        <!-- åŠ¨ç”»å¼€å…³æŒ‰é’® -->
        <button @click="visualConfig.enableAnimations = !visualConfig.enableAnimations"
                class="fixed top-4 right-4 z-50 p-2 rounded bg-black/60 hover:bg-black/80 border border-white/10 transition-colors group"
                title="åˆ‡æ¢åŠ¨ç”»æ•ˆæœ">
            <v-icon :name="visualConfig.enableAnimations ? 'zap' : 'zap-off'" :size="20"
                    :class="visualConfig.enableAnimations ? 'text-[var(--accent-gold)]' : 'text-[#8a9a9a]'"></v-icon>
            <span class="absolute right-full mr-2 top-1/2 -translate-y-1/2 text-xs text-white bg-black/90 px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none">
                {{ visualConfig.enableAnimations ? 'åŠ¨ç”»å·²å¯ç”¨' : 'åŠ¨ç”»å·²ç¦ç”¨' }}
            </span>
        </button>

        <!-- æ­¥éª¤ 0-5: å¼•å¯¼æµç¨‹ -->
        <transition :name="uiState.isLaunchingGeneration ? 'launch-animation' : 'step'" mode="out-in">
            
            <!-- STEP 0: å¯åŠ¨ -->
            <div v-if="step === 0" key="step0" class="text-center">
                <div class="w-24 h-24 mx-auto mb-6 relative">
                    <div class="absolute inset-0 border-2 border-[#d4b778] rotate-45 animate-[spin_10s_linear_infinite]"></div>
                    <div class="absolute inset-3 border-2 border-[#6fffe9] -rotate-45 animate-[spin_8s_linear_infinite_reverse]"></div>
                    <v-icon name="presentation" class="text-[#d4b778] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2" :size="40"></v-icon>
                </div>
                <h1 class="text-5xl md:text-6xl font-serif font-bold text-transparent bg-clip-text bg-gradient-to-b from-[#d4b778] to-[#fff] mb-4 tracking-widest drop-shadow-[0_0_20px_rgba(212,183,120,0.3)]">å¹»å¢ƒ PPT åŠ©æ‰‹</h1>
                <p class="text-[#8a9a9a] text-sm tracking-[0.3em] mb-12 uppercase typing-cursor">Presentation Matrix Loading...</p>
                <button @click="nextStep" class="game-btn px-10 py-4 bg-[#d4b778] text-[#0a1111] font-bold text-lg tracking-widest hover:bg-[#ffe0a3]">
                    è¿›å…¥å·¥ä½œå°
                </button>
            </div>

            <!-- STEP 1: é…ç½®è¿æ¥ -->
            <div v-else-if="step === 1" key="step1" class="game-container w-full max-w-lg p-8 rounded-xl text-center">
                <div class="text-[#6fffe9] text-xs font-bold tracking-widest mb-2 uppercase">Step 01 // Link</div>
                <h2 class="text-2xl font-serif text-white mb-6">æ¥å…¥æ™ºè¯†ç½‘ç»œ</h2>
                
                <div class="space-y-4 text-left">
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-1 block">API ç½‘å…³ (Base URL)</label>
                        <input v-model="config.baseUrl" class="magic-input w-full p-3 rounded" placeholder="https://api.openai.com/v1">
                    </div>
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-1 block">API å¯†é’¥ä»¤ç¬¦</label>
                        <input v-model="config.apiKey" type="password" class="magic-input w-full p-3 rounded" placeholder="sk-...">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-1 block">æ–‡å­—æ¨¡å‹</label>
                            <input v-model="config.textModel" class="magic-input w-full p-3 rounded text-sm" placeholder="gpt-5.2">
                        </div>
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-1 block">å›¾åƒæ¨¡å‹</label>
                            <input v-model="config.imageModel" class="magic-input w-full p-3 rounded text-sm" placeholder="gpt-image-1">
                        </div>
                    </div>
                </div>

                <div class="mt-8 flex justify-between">
                    <button @click="step--" class="text-xs text-[#8a9a9a] hover:text-white">ä¸­æ–­è¿æ¥</button>
                    <button @click="nextStep" :disabled="!config.apiKey" class="game-btn px-8 py-2 bg-[#6fffe9] text-[#0a1111] font-bold">éªŒè¯é€šè¿‡</button>
                </div>
            </div>

            <!-- STEP 2: ä»»åŠ¡ç®€æŠ¥ -->
            <div v-else-if="step === 2" key="step2" class="game-container p-10 rounded-2xl w-full max-w-lg text-center space-y-6">
                <div class="text-[var(--accent-gold)] text-xs font-bold tracking-widest uppercase">Step 02 // Mission</div>
                <h2 class="text-2xl font-bold text-white" style="font-family: var(--sys-font-head)">è¾“å…¥ç”ŸæˆæŒ‡ä»¤</h2>
                <div class="space-y-4 text-left">
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-1 block">æ ¸å¿ƒè®®é¢˜</label>
                        <textarea v-model="topic" class="magic-input w-full h-24 p-4 text-lg font-medium resize-none" placeholder="ä¾‹å¦‚ï¼š2025å¹´äººå·¥æ™ºèƒ½å‘å±•è¶‹åŠ¿..."></textarea>
                    </div>
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-1 block flex items-center gap-2">
                            <span class="w-1 h-1 bg-[var(--accent-cyan)] rounded-full"></span> è¡¥å……å’’æ–‡
                        </label>
                        <textarea v-model="additionalInfo" class="magic-input w-full h-20 p-3 text-xs resize-none" placeholder="ä¾‹å¦‚ï¼šåŒ…å«å›¢é˜Ÿä»‹ç»ã€é£æ ¼å¹½é»˜ã€å¼ºè°ƒæ•°æ®å¢é•¿..."></textarea>
                    </div>
                </div>
                <div class="flex justify-between items-center pt-4">
                    <button @click="step--" class="text-xs text-[#8a9a9a] hover:text-white">è¿”å›</button>
                    <button @click="generateOutline" :disabled="!topic.trim() || loading" class="game-btn px-8 py-2 bg-[var(--accent-gold)] text-[#0a1111] font-bold flex items-center gap-2">
                        <v-icon v-if="loading" name="loader-2" class="animate-spin" :size="16"></v-icon>
                        {{ loading ? 'è§£æä¸­...' : 'ç”Ÿæˆå¤§çº²' }}
                    </button>
                </div>
                <div v-if="error" class="text-red-400 text-xs">{{ error }}</div>
            </div>

            <!-- STEP 3: å¤§çº²ç¡®è®¤ -->
            <div v-else-if="step === 3" key="step3" class="game-container w-full max-w-4xl p-8 rounded-xl h-[75vh] flex flex-col">
                <div class="flex justify-between items-center mb-6 shrink-0">
                    <div>
                        <div class="text-[var(--accent-cyan)] text-xs font-bold tracking-widest uppercase">Step 03 // Structure</div>
                        <h2 class="text-2xl font-bold text-white" style="font-family: var(--sys-font-head)">ç¡®è®¤æˆ˜æœ¯å¤§çº²</h2>
                    </div>
                    <button @click="addSlide" class="px-3 py-1 border border-[#6fffe9]/30 text-[#6fffe9] hover:bg-[#6fffe9]/10 rounded text-xs flex items-center gap-1 transition-colors">
                        <v-icon name="plus" :size="14"></v-icon> å¢æ´èŠ‚ç‚¹
                    </button>
                </div>
                <div class="flex-1 overflow-y-auto custom-scrollbar pr-2 space-y-3">
                    <transition-group name="list">
                        <div v-for="(item, index) in outline" :key="index" class="group flex items-start gap-4 p-4 bg-black/40 border border-white/5 rounded-lg hover:border-[var(--accent-gold)] transition-colors relative">
                            <div class="text-[#8a9a9a] font-mono text-xs mt-2 w-6">0{{ index + 1 }}</div>
                            <div class="flex-1 space-y-2">
                                <input v-model="item.title" class="w-full bg-transparent border-b border-transparent focus:border-[var(--accent-gold)] text-white font-bold text-sm outline-none">
                                <textarea v-model="item.desc" rows="1" class="w-full bg-transparent border-b border-transparent focus:border-[var(--accent-cyan)] text-[#8a9a9a] text-xs outline-none resize-none"></textarea>
                            </div>
                            <button @click="removeSlide(index)" class="opacity-0 group-hover:opacity-100 text-[#8a9a9a] hover:text-red-400 absolute top-2 right-2"><v-icon name="x" :size="14"></v-icon></button>
                        </div>
                    </transition-group>
                </div>
                <div class="mt-6 flex justify-between shrink-0 pt-4 border-t border-white/10">
                    <button @click="step--" class="text-xs text-[#8a9a9a] hover:text-white">è¿”å›é‡ç½®</button>
                    <button @click="nextStep" class="game-btn px-8 py-2 bg-[var(--accent-cyan)] text-[#0a1111] font-bold">ç»“æ„ç¡®è®¤</button>
                </div>
            </div>

            <!-- STEP 4: é£æ ¼é€‰æ‹© (æ ¸å¿ƒå·®å¼‚ç‚¹) -->
            <div v-else-if="step === 4" key="step4" class="w-full max-w-5xl h-[80vh] flex flex-col">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-white mb-2" style="font-family: var(--sys-font-head)">é€‰æ‹©å…·è±¡åŒ–æ¨¡ç»„</h2>
                    <p class="text-[#8a9a9a] text-sm">ç³»ç»Ÿ UI ä¿æŒé­”æ³•è¿æ¥çŠ¶æ€ï¼Œä½†è¾“å‡ºäº§ç‰©å°†é€‚é…ç›®æ ‡ç»´åº¦çš„ç‰©ç†æ³•åˆ™</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div v-for="(theme, key) in PPT_THEMES" :key="key" 
                         @click="selectPptStyle(key)"
                         class="style-card relative rounded-xl overflow-hidden group h-40 flex flex-col"
                         :class="{ 'active': currentPptStyleKey === key }">
                        <!-- é£æ ¼é¢„è§ˆå›¾ (æ¨¡æ‹Ÿ) -->
                        <div class="flex-1 relative" :style="{background: theme.previewBg}">
                            <div class="absolute inset-0 flex flex-col items-center justify-center p-4">
                                <div class="w-16 h-2 rounded mb-1" :style="{background: theme.colors.accent}"></div>
                                <div class="w-10 h-2 rounded opacity-50" :style="{background: theme.colors.text}"></div>
                            </div>
                        </div>
                        <div class="p-3 bg-black/60 border-t border-white/10 flex justify-between items-center">
                            <span class="text-xs font-bold text-[#e0e0e0]">{{ theme.name }}</span>
                            <div class="w-2 h-2 rounded-full" :class="currentPptStyleKey === key ? 'bg-[var(--accent-gold)]' : 'bg-white/20'"></div>
                        </div>
                    </div>
                </div>

                <div class="game-container p-6 rounded-xl flex flex-wrap gap-8 items-center justify-center mx-auto w-full max-w-3xl">
                    <label class="flex items-center gap-2 cursor-pointer group">
                        <div class="w-4 h-4 border border-[var(--border-light)] flex items-center justify-center rounded bg-black/40">
                            <v-icon v-if="pptConfig.templateBg" name="check" :size="10" class="text-[var(--accent-gold)]"></v-icon>
                        </div>
                        <input type="file" @change="handleBgUpload" class="hidden" accept="image/*">
                        <span class="text-xs text-[#8a9a9a] group-hover:text-white transition-colors">
                            {{ pptConfig.templateBg ? 'å·²åŠ è½½è‡ªå®šä¹‰èƒŒæ™¯å›¾' : 'ä¸Šä¼ è‡ªå®šä¹‰èƒŒæ™¯å›¾ (è¦†ç›–é»˜è®¤é£æ ¼)' }}
                        </span>
                        <button v-if="pptConfig.templateBg" @click.stop="pptConfig.templateBg = null" class="ml-2 text-[10px] text-red-400 hover:underline">æ¸…é™¤</button>
                    </label>
                </div>

                <div class="flex justify-center gap-6 mt-auto">
                    <button @click="step--" class="text-xs text-[#8a9a9a] hover:text-white py-3">è¿”å›è°ƒæ•´</button>
                    <button @click="startFullGeneration" class="game-btn launch-btn px-12 py-3 bg-gradient-to-r from-[var(--accent-gold)] to-[var(--accent-cyan)] text-[#0a1111] text-lg font-bold shadow-[0_0_30px_rgba(212,183,120,0.3)]">
                        å¯åŠ¨ç”Ÿæˆä»ªå¼
                    </button>
                </div>
            </div>

            <!-- STEP 5: ç”Ÿæˆç»“æœ (é¢„è§ˆè§†çª— - å·¦å³ä¸¤æ å¸ƒå±€) -->
            <div v-else-if="step === 5" key="step5" class="w-full h-full flex gap-4 p-4">

                <!-- å·¦ä¾§: ç¼©ç•¥å›¾åˆ—è¡¨ -->
                <div class="w-80 flex-shrink-0 flex flex-col gap-4">
                    <div class="text-xs text-[var(--accent-gold)] font-bold tracking-wider uppercase">å¹»ç¯ç‰‡åˆ—è¡¨</div>

                    <div class="flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2">
                        <!-- å°é¢ç¼©ç•¥å›¾ -->
                        <div @click="selectSlide(-1)"
                             class="ppt-thumbnail group"
                             :class="{active: uiState.selectedSlideIndex === -1}"
                             :style="getPptPreviewStyle()">
                            <div class="absolute inset-0 flex flex-col items-center justify-center p-4 text-center">
                                <div class="text-[8px] font-bold tracking-widest mb-2 opacity-60"
                                     :style="{color: currentPptStyle.colors.accent, fontFamily: currentPptStyle.fonts.header}">
                                    PRESENTATION
                                </div>
                                <h1 class="text-sm font-bold mb-2 leading-tight"
                                    :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                    {{ topic }}
                                </h1>
                                <div class="w-12 h-0.5 mb-2" :style="{background: currentPptStyle.colors.accent}"></div>
                                <p class="text-[7px] opacity-60" :style="{color: currentPptStyle.colors.text}">{{ new Date().toLocaleDateString() }}</p>
                            </div>
                            <div class="absolute bottom-1 right-2 text-[8px] opacity-50" :style="{color: currentPptStyle.colors.text}">å°é¢</div>
                        </div>

                        <!-- å†…å®¹é¡µç¼©ç•¥å›¾ -->
                        <div v-for="(slide, index) in slides" :key="index"
                             @click="selectSlide(index)"
                             class="ppt-thumbnail group relative"
                             :class="{active: uiState.selectedSlideIndex === index}"
                             :style="getPptPreviewStyle()">

                            <!-- ç®€åŒ–çš„ç¼©ç•¥å›¾å†…å®¹ -->
                            <div class="absolute inset-0 p-3 flex flex-col">
                                <h3 class="text-[10px] font-bold mb-1 truncate"
                                    :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                    {{ slide.title }}
                                </h3>
                                <p class="text-[7px] opacity-70 line-clamp-3"
                                   :style="{color: currentPptStyle.colors.text}">
                                    {{ slide.content?.substring(0, 80) }}...
                                </p>
                            </div>

                            <div class="absolute bottom-1 left-2 text-[8px] opacity-30" :style="{color: currentPptStyle.colors.text}">
                                {{ index + 1 }}
                            </div>

                            <!-- å¸ƒå±€ç±»å‹æ ‡è¯† -->
                            <div class="absolute top-1 right-1 text-[7px] px-1.5 py-0.5 rounded bg-black/60"
                                 :style="{color: currentPptStyle.colors.accent}">
                                {{ slide.layout }}
                            </div>

                            <!-- ç”Ÿæˆä¸­é®ç½© -->
                            <div v-if="slide.isGenerating" class="absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-20">
                                <v-icon name="loader-2" :size="16" class="text-[var(--accent-cyan)] animate-spin"></v-icon>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å³ä¾§: å¤§é¢„è§ˆåŒºåŸŸ -->
                <div class="flex-1 flex flex-col items-center justify-center gap-4">
                    <div class="flex items-center justify-between w-full max-w-4xl">
                        <div class="text-xs text-[var(--accent-cyan)] font-bold tracking-wider uppercase">
                            {{ currentSlide.isCover ? 'å°é¢é¢„è§ˆ' : `ç¬¬ ${uiState.selectedSlideIndex + 1} é¡µé¢„è§ˆ` }}
                        </div>

                        <!-- æ“ä½œæŒ‰é’® (ä»…å†…å®¹é¡µæ˜¾ç¤º) -->
                        <div v-if="!currentSlide.isCover && uiState.selectedSlideIndex >= 0" class="flex gap-2">
                            <button @click="openEditModal(uiState.selectedSlideIndex)"
                                    class="px-3 py-1.5 rounded bg-white/10 hover:bg-white/20 text-white text-xs flex items-center gap-1.5 transition-colors">
                                <v-icon name="edit-3" :size="12"></v-icon> ç¼–è¾‘
                            </button>
                            <button @click="regenerateSlide(uiState.selectedSlideIndex)"
                                    :disabled="currentSlide.isRegenerating"
                                    class="px-3 py-1.5 rounded bg-[var(--accent-cyan)]/20 hover:bg-[var(--accent-cyan)]/30 text-[var(--accent-cyan)] text-xs flex items-center gap-1.5 transition-colors">
                                <v-icon :name="currentSlide.isRegenerating ? 'loader' : 'refresh-cw'" :size="12" :class="currentSlide.isRegenerating?'animate-spin':''"></v-icon> é‡æ–°ç”Ÿæˆ
                            </button>
                            <button @click="generateImage(uiState.selectedSlideIndex)"
                                    :disabled="currentSlide.imgLoading"
                                    class="px-3 py-1.5 rounded bg-[var(--accent-gold)]/20 hover:bg-[var(--accent-gold)]/30 text-[var(--accent-gold)] text-xs flex items-center gap-1.5 transition-colors">
                                <v-icon :name="currentSlide.imgLoading ? 'loader' : 'image'" :size="12" :class="currentSlide.imgLoading?'animate-spin':''"></v-icon> æ·»åŠ é…å›¾
                            </button>
                        </div>
                    </div>

                    <!-- å¤§é¢„è§ˆå®¹å™¨ -->
                    <div class="ppt-large-preview" :style="getPptPreviewStyle()">
                        <!-- å°é¢å¤§é¢„è§ˆ -->
                        <div v-if="currentSlide.isCover" class="absolute inset-0 flex flex-col items-center justify-center p-16 text-center">
                            <div class="text-xl font-bold tracking-widest mb-8 opacity-60"
                                 :style="{color: currentPptStyle.colors.accent, fontFamily: currentPptStyle.fonts.header}">
                                PRESENTATION
                            </div>
                            <h1 class="text-6xl font-bold mb-12 leading-tight px-8"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ topic }}
                            </h1>
                            <div class="w-40 h-1 mb-8" :style="{background: currentPptStyle.colors.accent}"></div>
                            <p class="text-lg opacity-60" :style="{color: currentPptStyle.colors.text}">{{ new Date().toLocaleDateString() }}</p>
                        </div>

                        <!-- ç»å…¸å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else-if="currentSlide.layout === 'classic'" class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-8"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <div class="flex-1 flex gap-10">
                                <div class="flex-1 flex flex-col gap-8">
                                    <p class="text-xl leading-relaxed opacity-80"
                                       :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.body}">
                                        {{ currentSlide.content }}
                                    </p>
                                    <div v-if="currentSlide.items && currentSlide.items.length" class="space-y-4">
                                        <div v-for="(item, i) in currentSlide.items" :key="i" class="flex items-start gap-3">
                                            <span class="text-lg" :style="{color: currentPptStyle.colors.accent}">â—</span>
                                            <span class="text-lg leading-tight flex-1" :style="{color: currentPptStyle.colors.text}">{{ item }}</span>
                                        </div>
                                    </div>
                                </div>
                                <div v-if="currentSlide.imgData" class="w-80 h-80 rounded overflow-hidden flex-shrink-0">
                                    <img :src="`data:image/png;base64,${currentSlide.imgData}`" class="w-full h-full object-cover">
                                </div>
                            </div>
                        </div>

                        <!-- å¤§æ•°æ®å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else-if="currentSlide.layout === 'big-data'" class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-8"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <div class="flex-1 flex flex-col items-center justify-center">
                                <div class="text-9xl font-bold mb-8" :style="{color: currentPptStyle.colors.accent, fontFamily: currentPptStyle.fonts.header}">
                                    {{ currentSlide.dataValue || '89%' }}
                                </div>
                                <div class="text-3xl mb-8 opacity-80" :style="{color: currentPptStyle.colors.text}">
                                    {{ currentSlide.dataLabel || currentSlide.title }}
                                </div>
                                <p class="text-xl text-center px-32 leading-relaxed opacity-70"
                                   :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.body}">
                                    {{ currentSlide.content }}
                                </p>
                            </div>
                        </div>

                        <!-- æ—¶é—´çº¿å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else-if="currentSlide.layout === 'timeline'" class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-6"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <p v-if="currentSlide.content" class="text-lg mb-8 opacity-70" :style="{color: currentPptStyle.colors.text}">
                                {{ currentSlide.content }}
                            </p>
                            <div v-if="currentSlide.items && currentSlide.items.length" class="flex-1 flex flex-col justify-center gap-6 pl-12">
                                <div v-for="(item, i) in currentSlide.items" :key="i" class="flex items-start gap-6">
                                    <div class="flex flex-col items-center">
                                        <div class="w-6 h-6 rounded-full" :style="{background: currentPptStyle.colors.accent}"></div>
                                        <div v-if="i < currentSlide.items.length - 1" class="w-1 h-16" :style="{background: currentPptStyle.colors.accent}"></div>
                                    </div>
                                    <span class="text-lg leading-tight flex-1 pt-1" :style="{color: currentPptStyle.colors.text}">{{ item }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- å¯¹æ¯”å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else-if="currentSlide.layout === 'comparison'" class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-6"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <p v-if="currentSlide.content" class="text-lg mb-8 opacity-70" :style="{color: currentPptStyle.colors.text}">
                                {{ currentSlide.content }}
                            </p>
                            <div v-if="currentSlide.items && currentSlide.items.length" class="flex-1 flex gap-10">
                                <div class="flex-1">
                                    <div class="text-2xl font-bold mb-4" :style="{color: currentPptStyle.colors.accent}">
                                        {{ currentSlide.leftTitle || 'æ–¹æ¡ˆ A' }}
                                    </div>
                                    <div class="space-y-3">
                                        <div v-for="(item, i) in currentSlide.items.slice(0, Math.ceil(currentSlide.items.length/2))" :key="i" class="flex items-start gap-3">
                                            <span class="text-lg" :style="{color: currentPptStyle.colors.accent}">â—</span>
                                            <span class="text-lg leading-tight" :style="{color: currentPptStyle.colors.text}">{{ item }}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="w-px" :style="{background: currentPptStyle.colors.accent, opacity: 0.3}"></div>
                                <div class="flex-1">
                                    <div class="text-2xl font-bold mb-4" :style="{color: currentPptStyle.colors.accent}">
                                        {{ currentSlide.rightTitle || 'æ–¹æ¡ˆ B' }}
                                    </div>
                                    <div class="space-y-3">
                                        <div v-for="(item, i) in currentSlide.items.slice(Math.ceil(currentSlide.items.length/2))" :key="i" class="flex items-start gap-3">
                                            <span class="text-lg" :style="{color: currentPptStyle.colors.accent}">â—</span>
                                            <span class="text-lg leading-tight" :style="{color: currentPptStyle.colors.text}">{{ item }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- å›¾ç‰‡ç½‘æ ¼å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else-if="currentSlide.layout === 'image-grid'" class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-6"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <p v-if="currentSlide.content" class="text-lg mb-8 opacity-70" :style="{color: currentPptStyle.colors.text}">
                                {{ currentSlide.content }}
                            </p>
                            <div class="flex-1 grid grid-cols-2 gap-6">
                                <div v-for="i in 4" :key="i" class="border-2 border-dashed rounded flex items-center justify-center"
                                     :style="{borderColor: currentPptStyle.colors.accent, opacity: 0.3}">
                                    <v-icon name="image" :size="64" :style="{color: currentPptStyle.colors.text, opacity: 0.4}"></v-icon>
                                </div>
                            </div>
                        </div>

                        <!-- å›¾è¡¨å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else-if="currentSlide.layout === 'chart'" class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-6"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <p v-if="currentSlide.content" class="text-lg mb-8 opacity-70" :style="{color: currentPptStyle.colors.text}">
                                {{ currentSlide.content }}
                            </p>
                            <div class="flex-1 border-2 border-dashed rounded flex items-center justify-center"
                                 :style="{borderColor: currentPptStyle.colors.accent, opacity: 0.3}">
                                <v-icon name="bar-chart-3" :size="128" :style="{color: currentPptStyle.colors.accent, opacity: 0.4}"></v-icon>
                            </div>
                        </div>

                        <!-- é»˜è®¤å¸ƒå±€å¤§é¢„è§ˆ -->
                        <div v-else class="absolute inset-0 p-12 flex flex-col">
                            <h3 class="text-4xl font-bold mb-8"
                                :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.header}">
                                {{ currentSlide.title }}
                            </h3>
                            <p class="text-xl leading-relaxed opacity-80 flex-1"
                               :style="{color: currentPptStyle.colors.text, fontFamily: currentPptStyle.fonts.body}">
                                {{ currentSlide.content }}
                            </p>
                        </div>

                        <!-- ç”Ÿæˆä¸­é®ç½© -->
                        <div v-if="currentSlide.isGenerating" class="absolute inset-0 bg-black/80 backdrop-blur-sm flex flex-col items-center justify-center z-20">
                            <v-icon name="loader-2" :size="64" class="text-[var(--accent-cyan)] animate-spin mb-4"></v-icon>
                            <span class="text-2xl text-[var(--accent-cyan)]">æ­£åœ¨ç”Ÿæˆå†…å®¹...</span>
                        </div>
                    </div>
                </div>

            </div>

        </transition>

        <!-- åº•éƒ¨å¯¼èˆªæ  (ç»“æœé¡µæ—¶æ˜¾ç¤º) -->
        <div v-if="step === 5" class="fixed bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black/90 to-transparent backdrop-blur-sm z-50 border-t border-white/10">
            <div class="max-w-4xl mx-auto flex justify-between items-center">
                <button @click="goBackToStyleSelection" class="text-xs text-[#8a9a9a] hover:text-white flex items-center gap-2">
                    <v-icon name="chevron-left" :size="14"></v-icon> è¿”å›è°ƒæ•´é£æ ¼
                </button>
                <button @click="exportPPT" class="game-btn px-10 py-3 bg-gradient-to-r from-[#d4b778] to-[#6fffe9] text-[#0a1111] font-bold text-lg flex items-center gap-3">
                    <v-icon name="download" :size="18"></v-icon>
                    å¯¼å‡ºå…·è±¡åŒ–æ–‡ä»¶
                </button>
            </div>
        </div>

        <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
        <div v-if="uiState.modalImg" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/90 backdrop-blur-md p-8" @click="uiState.modalImg = null">
            <div class="relative p-1 border border-[var(--accent-gold)] bg-black shadow-[0_0_50px_rgba(212,183,120,0.3)]">
                <img :src="`data:image/png;base64,${uiState.modalImg}`" class="max-h-[85vh] block">
            </div>
        </div>

        <!-- ç¼–è¾‘å†…å®¹æ¨¡æ€æ¡† -->
        <div v-if="uiState.isEditing" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4" @click.self="closeEditModal">
            <div class="game-container w-full max-w-2xl p-6 rounded-lg max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <span class="text-[#6fffe9] font-bold tracking-widest text-sm">é‡å¡‘æ­¤é¡µå†…å®¹</span>
                        <p class="text-[#8a9a9a] text-[10px] mt-1">ç¼–è¾‘å†…å®¹æˆ–ä½¿ç”¨AIé‡æ–°ç”Ÿæˆ</p>
                    </div>
                    <button @click="closeEditModal"><v-icon name="x" :size="18" class="text-[#8a9a9a] hover:text-white"></v-icon></button>
                </div>

                <div class="space-y-4">
                    <!-- å¸ƒå±€é€‰æ‹© -->
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">æ’ç‰ˆå¸ƒå±€</label>
                        <select v-model="editForm.layout" class="magic-input w-full h-10 px-3 rounded text-sm">
                            <option value="classic">ğŸ“„ ç»å…¸å¸ƒå±€ - æ–‡æœ¬+åˆ—è¡¨+å›¾ç‰‡ (é€šç”¨å†…å®¹)</option>
                            <option value="big-data">ğŸ“Š å¤§æ•°æ®å¸ƒå±€ - çªå‡ºæ•°å­—å±•ç¤º (ç»Ÿè®¡æ•°æ®)</option>
                            <option value="timeline">â±ï¸ æ—¶é—´çº¿å¸ƒå±€ - æµç¨‹æ­¥éª¤ (é¡¹ç›®è¿›åº¦)</option>
                            <option value="comparison">âš–ï¸ å¯¹æ¯”å¸ƒå±€ - å·¦å³ä¸¤åˆ— (æ–¹æ¡ˆå¯¹æ¯”)</option>
                            <option value="image-grid">ğŸ–¼ï¸ å›¾ç‰‡ç½‘æ ¼ - å¤šå›¾å±•ç¤º (æ¡ˆä¾‹é›†)</option>
                            <option value="chart">ğŸ“ˆ å›¾è¡¨å¸ƒå±€ - æ•°æ®å¯è§†åŒ– (è¶‹åŠ¿åˆ†æ)</option>
                        </select>
                    </div>

                    <!-- æ ‡é¢˜ -->
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">æ ‡é¢˜</label>
                        <input v-model="editForm.title" class="magic-input w-full h-10 px-3 rounded text-sm" placeholder="å¹»ç¯ç‰‡æ ‡é¢˜">
                    </div>

                    <!-- å¤§æ•°æ®å¸ƒå±€ä¸“ç”¨å­—æ®µ -->
                    <div v-if="editForm.layout === 'big-data'" class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">æ•°å€¼</label>
                            <input v-model="editForm.dataValue" class="magic-input w-full h-10 px-3 rounded text-sm" placeholder="ä¾‹å¦‚: 89%">
                        </div>
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">æ ‡ç­¾</label>
                            <input v-model="editForm.dataLabel" class="magic-input w-full h-10 px-3 rounded text-sm" placeholder="ä¾‹å¦‚: å¢é•¿ç‡">
                        </div>
                    </div>

                    <!-- å¯¹æ¯”å¸ƒå±€ä¸“ç”¨å­—æ®µ -->
                    <div v-if="editForm.layout === 'comparison'" class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">å·¦ä¾§æ ‡é¢˜</label>
                            <input v-model="editForm.leftTitle" class="magic-input w-full h-10 px-3 rounded text-sm" placeholder="ä¾‹å¦‚: æ–¹æ¡ˆ A">
                        </div>
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">å³ä¾§æ ‡é¢˜</label>
                            <input v-model="editForm.rightTitle" class="magic-input w-full h-10 px-3 rounded text-sm" placeholder="ä¾‹å¦‚: æ–¹æ¡ˆ B">
                        </div>
                    </div>

                    <!-- å†…å®¹ -->
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">ä¸»è¦å†…å®¹</label>
                        <textarea v-model="editForm.content" rows="4" class="magic-input w-full p-3 rounded text-sm" placeholder="è¯¦ç»†æè¿°å†…å®¹..."></textarea>
                    </div>

                    <!-- åˆ—è¡¨é¡¹ -->
                    <div>
                        <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">åˆ—è¡¨é¡¹ (æ¯è¡Œä¸€é¡¹)</label>
                        <textarea v-model="editForm.pointsStr" rows="3" class="magic-input w-full p-3 rounded text-sm" placeholder="ç¬¬ä¸€é¡¹&#10;ç¬¬äºŒé¡¹&#10;ç¬¬ä¸‰é¡¹"></textarea>
                    </div>

                    <!-- åˆ†éš”çº¿ -->
                    <div class="border-t border-white/10 my-6"></div>

                    <!-- AI é‡æ–°ç”Ÿæˆéƒ¨åˆ† -->
                    <div class="bg-black/40 p-4 rounded border border-[var(--accent-cyan)]/30">
                        <div class="flex items-center gap-2 mb-3">
                            <v-icon name="sparkles" :size="14" class="text-[var(--accent-cyan)]"></v-icon>
                            <span class="text-[var(--accent-cyan)] text-xs font-bold uppercase">AI é‡æ–°ç”Ÿæˆ</span>
                        </div>
                        <div>
                            <label class="text-[10px] text-[#8a9a9a] uppercase mb-2 block">è‡ªå®šä¹‰æç¤ºè¯ (å¯é€‰)</label>
                            <textarea
                                v-model="editForm.customPrompt"
                                rows="2"
                                class="magic-input w-full p-3 rounded text-xs"
                                placeholder="ä¾‹å¦‚: æ›´ä¸“ä¸šçš„è¯­æ°”ï¼Œæ·»åŠ æ•°æ®æ”¯æ’‘ï¼Œä¾§é‡æŠ€æœ¯ç»†èŠ‚...&#10;ç•™ç©ºåˆ™ä½¿ç”¨åŸå§‹å¤§çº²é‡æ–°ç”Ÿæˆ"></textarea>
                        </div>
                        <button
                            @click="regenerateSlideWithPrompt(uiState.editingIndex)"
                            :disabled="slides[uiState.editingIndex]?.isRegenerating"
                            class="game-btn w-full mt-3 px-4 py-2 bg-[var(--accent-cyan)] text-[#0a1111] text-xs font-bold flex items-center justify-center gap-2">
                            <v-icon :name="slides[uiState.editingIndex]?.isRegenerating ? 'loader' : 'wand-2'" :size="14" :class="slides[uiState.editingIndex]?.isRegenerating ? 'animate-spin' : ''"></v-icon>
                            {{ slides[uiState.editingIndex]?.isRegenerating ? 'ç”Ÿæˆä¸­...' : 'ä½¿ç”¨AIé‡æ–°ç”Ÿæˆ' }}
                        </button>
                    </div>
                </div>

                <!-- åº•éƒ¨æŒ‰é’® -->
                <div class="mt-6 flex justify-end gap-3">
                    <button @click="closeEditModal" class="px-6 py-2 text-xs text-[#8a9a9a] hover:text-white transition-colors">å–æ¶ˆ</button>
                    <button @click="saveEdit" class="game-btn px-8 py-2 bg-[var(--accent-gold)] text-[#0a1111] text-sm font-bold">ä¿å­˜ä¿®æ”¹</button>
                </div>
            </div>
        </div>

    </div>

    <!-- ES Modules å…¥å£ -->
    <script type="module" src="js/main.js"></script>

    <script>
        // JavaScript ä»£ç å·²æ¨¡å—åŒ–è‡³ js/ ç›®å½•
        // ä¸»é¢˜é…ç½®: js/config/themes.js
        // ä¸»å…¥å£: js/main.js (ES Module)
    </script>
</body>
</html>
