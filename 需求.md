

### 第一部分：新增功能需求 (New Features)
*目的是扩展能力边界，解决实际办公场景痛点。*

#### 1. 多模态输入增强 (Input Enhancement)
目前仅支持“主题”输入，需增加基于材料生成的路径。
* **长文本/文档转 PPT：**
    * **功能描述：** 支持粘贴长篇文章，或上传 `.md` / `.txt` / `.docx` 文件（前端使用 `mammoth.js` 或 `pdf.js` 解析）。
    * **逻辑：** 增加“精读与分段”步骤，AI 需先将长文拆解为 Slide 维度的要点，再生成内容。
* **结构化指令输入：**
    * **功能描述：** 允许用户设置“演讲对象”（如同行、学生、投资人）和“演讲时长”。
    * **作用：** 这些参数作为 System Prompt 注入，控制生成内容的深度和语气。

#### 2. 编辑体验升级 (Editor Experience)
目前仅支持大纲增删改，需增强对生成结果的掌控力。
* **幻灯片拖拽排序：**
    * **功能描述：** 在左侧缩略图栏，允许用户通过 Drag & Drop (DnD) 调整页面顺序。
* **局部 AI 重写（Magic Edit）：**
    * **功能描述：** 在右侧预览区选中某段文本，弹出浮窗工具栏：“精简”、“扩写”、“换个说法”。
* **图表可视化支持：**
    * **功能描述：** 针对“图表布局”，不仅仅生成文字描述，而是生成真实数据。
    * **实现：** 前端渲染 ECharts 预览，导出时使用 `PptxGenJS` 的 `addChart` API 生成原生 PPT 图表（非截图）。

#### 3. 视觉与素材增强 (Visual Assets)
解决“配图单一”和“风格冲突”问题。
* **双源配图机制：**
    * **功能描述：** 除了 `gpt-image-1` 生成图片（慢且贵），增加“网络搜图”选项（接入 Unsplash API 或 Bing Image Search API）。
    * **交互：** 用户点击图片可选择“AI 重新生成”或“关键词搜图替换”。
* **真实预览模式：**
    * **功能描述：** 当前 UI 是赛博朋克风，但 PPT 可能是商务风。预览区应增加“沉浸模式”，去除外部 UI 干扰，纯净展示 PPT 效果。

#### 4. 导出增强 (Export Plus)
* **演讲者逐字稿 (Speaker Notes)：**
    * **功能描述：** AI 生成正文时，同步生成 200 字左右的演讲备注。
    * **导出：** 写入 `.pptx` 文件的备注区（`addNotes` 方法）。

---

### 第二部分：重构与完善需求 (Refactoring & Optimization)
*目的是解决技术债务，提升稳定性和开发体验。*

#### 1. 工程化重构 (Modern Build System)
**现状问题：** 依赖原生 ESM 和 `http-server`，导致必须本地起服务，且无法使用 npm 生态中的复杂包。
* **重构方案：** 迁移至 **Vite + Vue 3 (SFC)** 架构。
    * **动作：** 初始化 Vite 项目，将 HTML 中的逻辑拆分为 `.vue` 单文件组件。
    * **收益：** 支持热更新 (HMR)、打包构建、TypeScript 支持（可选）、更易部署到 Vercel/Netlify 等静态托管平台。

#### 2. 状态管理优化 (State Management)
**现状问题：** 可能通过 Props 层层传递或直接操作 DOM，配置存 LocalStorage 逻辑分散。
* **重构方案：** 引入 **Pinia**。
    * **Store 设计：**
        * `ConfigStore`: 管理 API Key、模型设置（持久化）。
        * `PresentationStore`: 管理当前 PPT 的大纲、每页内容、选中状态（无需持久化，刷新即重置或 SessionStorage）。
    * **收益：** 组件解耦，便于实现“撤销/重做”功能。

#### 3. PptxGenJS 封装层 (PPT Engine Abstraction)
**现状问题：** 生成逻辑可能与 UI 逻辑耦合。
* **重构方案：** 建立独立的 `PPTBuilder` 类。
    * **逻辑：** 将“Vue 组件样式”与“PptxGenJS 导出样式”做映射配置。
    * **目标：** 确保“所见即所得”。目前网页上的 Tailwind 样式需要精确转换为 PptxGenJS 的尺寸和位置参数。建立一套统一的 `ThemeSchema`，同时驱动 Web 渲染和 PPT 导出。

#### 4. 错误处理与流式响应 (Robustness)
**现状问题：** AI 生成若中间失败，可能导致整个流程卡死；等待时间无反馈。
* **完善方案：**
    * **流式解析 (Streaming)：** 如果 API 支持 stream，前端应实时打字机显示内容，而不是转圈等待。
    * **容错重试：** 单页生成失败时，UI 显示“重试”按钮，而不是让用户刷新页面重来。

---

### 第三部分：推荐的开发路线图 (Roadmap)

建议按以下顺序执行开发：

**阶段一：工程化底座 (必须最先做)**
1.  使用 Vite 重构项目结构。
2.  引入 Pinia 管理状态。
3.  确保现有的 10 个主题和 6 个布局在 Vite 环境下正常运行。

**阶段二：核心体验打磨**
1.  **PPTBuilder 封装**：统一 Web 预览和 PPTX 导出的样式定义。
2.  **演讲稿导出**：这是高价值且易实现的功能。
3.  **图表支持**：打通数据到可视化图表的链路。

**阶段三：高级功能**
1.  **文档上传解析**：引入 `mammoth.js`。
2.  **图片搜索 API 接入**：降低生成成本，提高配图真实性。
3.  **局部 AI 编辑**：提升用户对内容的精细控制。